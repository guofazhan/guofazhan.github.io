<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="baidu-site-verification" content="1EB8XoOl0C"><meta name="google-site-verification" content="K7thEgdLm0UfRWJ5MGdF7sCcjClSzAlxFLPv2Oz5CGM"><title> Spring-Cloud-Gateway初始化 · Mr.G-博客</title><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Spring-Cloud-Gateway初始化 - Mr.G"><meta name="keywords"><meta name="author" content="Mr.G"><link rel="short icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/bubuzou.css"><link rel="search" type="application/opensearchdescription+xml" href="https://guofazhan.github.io/atom.xml" title="Mr.G-博客"></head><body><header><div class="header row"> <a href="/" class="logo-link"><img src="/images/logo.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" data-hover="博文" class="nav-list-link">博文</a></li><li class="nav-list-item"><a href="/archives/" target="_self" data-hover="归档" class="nav-list-link">归档</a></li><li class="nav-list-item"><a href="/about/" target="_self" data-hover="关于" class="nav-list-link">关于</a></li></ul><div class="search"><a id="search_btn" href="#search"></a></div></div></header><div class="row scroll-con"><section class="container"><!-- for archive page--><div id="postAr" class="post"><article class="post-block"><h1 class="post-title">Spring-Cloud-Gateway初始化</h1><div class="post-info">2018-09-03<!-- p.visit--><!--    if (is_home())--><!--        i(data-hk-page='http://bubuzou.com'+url_for(item.path)) ---><!--    else--><!--        i(data-hk-page="current") ---><!--   span 次访问--></div><div class="post-content"><p>Spring-Cloud项目使用EnableAutoConfiguration注解自动<br>初始化配置信息，Spring-Cloud-Gateway同样，Spring-Cloud-Gateway下的spring.factories如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># Auto Configure</span><br><span class="line">org.springframework.boot.autoconfigure.EnableAutoConfiguration=\</span><br><span class="line">//依赖包的校验配置</span><br><span class="line">org.springframework.cloud.gateway.config.GatewayClassPathWarningAutoConfiguration,\</span><br><span class="line">//网关的核心配置</span><br><span class="line">org.springframework.cloud.gateway.config.GatewayAutoConfiguration,\</span><br><span class="line">//负载均衡相关依赖配置信息</span><br><span class="line">org.springframework.cloud.gateway.config.GatewayLoadBalancerClientAutoConfiguration,\</span><br><span class="line">//流控的依赖配置信息</span><br><span class="line">org.springframework.cloud.gateway.config.GatewayRedisAutoConfiguration,\</span><br><span class="line">//注册中心相关的依赖配置</span><br><span class="line">org.springframework.cloud.gateway.discovery.GatewayDiscoveryClientAutoConfiguration</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h4 id="析配置功能"><a href="#析配置功能" class="headerlink" title="析配置功能"></a>析配置功能</h4><blockquote>
<p>  分析配置功能前先了解下springboot常用的注解的含义</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">执行顺序</span><br><span class="line">@AutoConfigureAfter：在指定的配置类初始化后再加载</span><br><span class="line">@AutoConfigureBefore：在指定的配置类初始化前加载</span><br><span class="line">@AutoConfigureOrder：数越小越先初始化</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">条件配置</span><br><span class="line">@ConditionalOnClass ： classpath中存在该类时起效</span><br><span class="line">@ConditionalOnMissingClass ： classpath中不存在该类时起效</span><br><span class="line">@ConditionalOnBean ： DI容器中存在该类型Bean时起效</span><br><span class="line">@ConditionalOnMissingBean ： DI容器中不存在该类型Bean时起效</span><br><span class="line">@ConditionalOnSingleCandidate ： DI容器中该类型Bean只有一个或@Primary的只有一个时起效</span><br><span class="line">@ConditionalOnExpression ： SpEL表达式结果为true时</span><br><span class="line">@ConditionalOnProperty ： 参数设置或者值一致时起效</span><br><span class="line">@ConditionalOnResource ： 指定的文件存在时起效</span><br><span class="line">@ConditionalOnJndi ： 指定的JNDI存在时起效</span><br><span class="line">@ConditionalOnJava ： 指定的Java版本存在时起效</span><br><span class="line">@ConditionalOnWebApplication ： Web应用环境下起效</span><br><span class="line">@ConditionalOnNotWebApplication ： 非Web应用环境下起效</span><br></pre></td></tr></table></figure>
<hr>
<ol>
<li>GatewayClassPathWarningAutoConfiguration配置<blockquote>
<p>GatewayClassPathWarningAutoConfiguration配置用于检查项目是否正确导入 spring-boot-starter-webflux 依赖，而不是错误导入 spring-boot-starter-web 依赖，同时 GatewayClassPathWarningAutoConfiguration配置在EnableAutoConfiguration配置加载前加载<br>接下来我看代码如何实现</p>
</blockquote>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">//执行顺序注解</span><br><span class="line">//当前注解标识需要在GatewayAutoConfiguration前加载此配置</span><br><span class="line">@AutoConfigureBefore(GatewayAutoConfiguration.class)</span><br><span class="line">public class GatewayClassPathWarningAutoConfiguration &#123;</span><br><span class="line">	@Configuration</span><br><span class="line">	//条件判断注解</span><br><span class="line">	//classpath中存在org.springframework.web.servlet.DispatcherServlet时起效，标识项目导入了spring-boot-starter-web包</span><br><span class="line">	@ConditionalOnClass(name = &quot;org.springframework.web.servlet.DispatcherServlet&quot;)</span><br><span class="line">	protected static class SpringMvcFoundOnClasspathConfiguration &#123;</span><br><span class="line"></span><br><span class="line">		public SpringMvcFoundOnClasspathConfiguration() &#123;</span><br><span class="line">		   //当前项目导入了spring-boot-starter-web依赖时，打印警告日志</span><br><span class="line">			log.warn(BORDER+&quot;Spring MVC found on classpath, which is incompatible with Spring Cloud Gateway at this time. &quot;+</span><br><span class="line">					&quot;Please remove spring-boot-starter-web dependency.&quot;+BORDER);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	@Configuration</span><br><span class="line">	//条件判断注解</span><br><span class="line">	//classpath中不存在org.springframework.web.reactive.DispatcherHandler时起效，标识项目未导入了spring-boot-starter-webflux包</span><br><span class="line">	@ConditionalOnMissingClass(&quot;org.springframework.web.reactive.DispatcherHandler&quot;)</span><br><span class="line">	protected static class WebfluxMissingFromClasspathConfiguration &#123;</span><br><span class="line">		public WebfluxMissingFromClasspathConfiguration() &#123;</span><br><span class="line">	  //当前项目未导入了boot-starter-webflux依赖时，打印警告日志</span><br><span class="line">			log.warn(BORDER+&quot;Spring Webflux is missing from the classpath, which is required for Spring Cloud Gateway at this time. &quot;+</span><br><span class="line">					&quot;Please add spring-boot-starter-webflux dependency.&quot;+BORDER);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>GatewayLoadBalancerClientAutoConfiguration<blockquote>
<p>GatewayLoadBalancerClientAutoConfiguration配置作用是初始化 LoadBalancerClientFilter 路由的负载均衡拦截器</p>
</blockquote>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">//条件判断注解</span><br><span class="line">//classpath中存在LoadBalancerClient和RibbonAutoConfiguration和DispatcherHandler时此配置起效</span><br><span class="line">@ConditionalOnClass(&#123;LoadBalancerClient.class, RibbonAutoConfiguration.class, DispatcherHandler.class&#125;)</span><br><span class="line">//执行顺序注解</span><br><span class="line">@AutoConfigureAfter(RibbonAutoConfiguration.class)</span><br><span class="line">public class GatewayLoadBalancerClientAutoConfiguration &#123;</span><br><span class="line">	// GlobalFilter beans</span><br><span class="line">	@Bean</span><br><span class="line">	//条件判断注解</span><br><span class="line">	//DI容器中存在LoadBalancerClient类型Bean时起效</span><br><span class="line">	@ConditionalOnBean(LoadBalancerClient.class)</span><br><span class="line">	public LoadBalancerClientFilter loadBalancerClientFilter(LoadBalancerClient client) &#123;</span><br><span class="line">		return new LoadBalancerClientFilter(client);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>GatewayRedisAutoConfiguration<blockquote>
<p>GatewayRedisAutoConfiguration 配置作用是初始化初始化 RedisRateLimiter  限流功能的RequestRateLimiterGatewayFilterFactory 基于 RedisRateLimiter 实现网关的限流功能，<strong>代码略</strong></p>
</blockquote>
</li>
<li>GatewayAutoConfiguration<blockquote>
<p>GatewayAutoConfiguration配置是Spring Cloud Gateway 核心配置类，初始化如下 ： </p>
<ul>
<li>NettyConfiguration 底层通信netty配置</li>
<li>GlobalFilter  （AdaptCachedBodyGlobalFilter，RouteToRequestUrlFilter，ForwardRoutingFilter，ForwardPathFilter，WebsocketRoutingFilter，WeightCalculatorWebFilter等）</li>
<li>FilteringWebHandler</li>
<li>GatewayProperties</li>
<li>PrefixPathGatewayFilterFactory</li>
<li>RoutePredicateFactory</li>
<li>RouteDefinitionLocator</li>
<li>RouteLocator</li>
<li>RoutePredicateHandlerMapping 查找匹配到 Route并进行处理</li>
<li>GatewayWebfluxEndpoint 管理网关的 HTTP API </li>
</ul>
</blockquote>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">//条件注解</span><br><span class="line">//通过 spring.cloud.gateway.enabled配置网关的开启与关闭</span><br><span class="line">//matchIfMissing = true =&gt; 网关默认开启。</span><br><span class="line">@ConditionalOnProperty(name = &quot;spring.cloud.gateway.enabled&quot;, matchIfMissing = true)</span><br><span class="line">@EnableConfigurationProperties</span><br><span class="line">@AutoConfigureBefore(HttpHandlerAutoConfiguration.class)</span><br><span class="line">@AutoConfigureAfter(&#123;GatewayLoadBalancerClientAutoConfiguration.class, GatewayClassPathWarningAutoConfiguration.class&#125;)</span><br><span class="line">@ConditionalOnClass(DispatcherHandler.class)</span><br><span class="line">public class GatewayAutoConfiguration &#123;</span><br><span class="line">   	@Configuration</span><br><span class="line">   	//当classpath中存在HttpClient起效</span><br><span class="line">	@ConditionalOnClass(HttpClient.class)</span><br><span class="line">	protected static class NettyConfiguration &#123;</span><br><span class="line">	    .....略</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	//加载配置beans</span><br><span class="line">	// ConfigurationProperty beans</span><br><span class="line">	@Bean</span><br><span class="line">	public GatewayProperties gatewayProperties() &#123;</span><br><span class="line">		return new GatewayProperties();</span><br><span class="line">	&#125;</span><br><span class="line">	@Bean</span><br><span class="line">	public SecureHeadersProperties secureHeadersProperties() &#123;</span><br><span class="line">		return new SecureHeadersProperties();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	// GlobalFilter beans</span><br><span class="line">    //加载全局的拦截器</span><br><span class="line">	@Bean</span><br><span class="line">	public AdaptCachedBodyGlobalFilter adaptCachedBodyGlobalFilter() &#123;</span><br><span class="line">		return new AdaptCachedBodyGlobalFilter();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Bean</span><br><span class="line">	public RouteToRequestUrlFilter routeToRequestUrlFilter() &#123;</span><br><span class="line">		return new RouteToRequestUrlFilter();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Bean</span><br><span class="line">	@ConditionalOnBean(DispatcherHandler.class)</span><br><span class="line">	public ForwardRoutingFilter forwardRoutingFilter(DispatcherHandler dispatcherHandler) &#123;</span><br><span class="line">		return new ForwardRoutingFilter(dispatcherHandler);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Bean</span><br><span class="line">	public ForwardPathFilter forwardPathFilter() &#123;</span><br><span class="line">		return new ForwardPathFilter();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Bean</span><br><span class="line">	public WebSocketService webSocketService() &#123;</span><br><span class="line">		return new HandshakeWebSocketService();</span><br><span class="line">	&#125;</span><br><span class="line">	@Bean</span><br><span class="line">	public WebsocketRoutingFilter websocketRoutingFilter(WebSocketClient webSocketClient,</span><br><span class="line">		return new WebsocketRoutingFilter(webSocketClient, webSocketService, headersFilters);</span><br><span class="line">	&#125;</span><br><span class="line">	@Bean</span><br><span class="line">	public WeightCalculatorWebFilter weightCalculatorWebFilter(Validator validator) &#123;</span><br><span class="line">		return new WeightCalculatorWebFilter(validator);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>GatewayDiscoveryClientAutoConfiguration<blockquote>
<p>GatewayDiscoveryClientAutoConfiguration配置的作用是初始化配置路由中的注册发现服务信息</p>
</blockquote>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">//同4</span><br><span class="line">@ConditionalOnProperty(name = &quot;spring.cloud.gateway.enabled&quot;, matchIfMissing = true)</span><br><span class="line">@AutoConfigureBefore(GatewayAutoConfiguration.class)</span><br><span class="line">@ConditionalOnClass(&#123;DispatcherHandler.class, DiscoveryClient.class&#125;)</span><br><span class="line">@EnableConfigurationProperties</span><br><span class="line">public class GatewayDiscoveryClientAutoConfiguration &#123;</span><br><span class="line"></span><br><span class="line">	@Bean</span><br><span class="line">	//当classpath中存在DiscoveryClient起效</span><br><span class="line">	@ConditionalOnBean(DiscoveryClient.class)</span><br><span class="line">	//通过spring.cloud.gateway.discovery.locator.enabled配置注册中心查找的开启与关闭</span><br><span class="line">	@ConditionalOnProperty(name = &quot;spring.cloud.gateway.discovery.locator.enabled&quot;)</span><br><span class="line">	public DiscoveryClientRouteDefinitionLocator discoveryClientRouteDefinitionLocator(</span><br><span class="line">			DiscoveryClient discoveryClient, DiscoveryLocatorProperties properties) &#123;</span><br><span class="line">		return new DiscoveryClientRouteDefinitionLocator(discoveryClient, properties);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>通过自动加载初始化上述五个配置实例Spring-Cloud-Gateway就完成自身的信息加载和初始化工作，而对于使用者来说是无感知的</strong></p>
</div></article></div><div class="right-container"><div class="widget"><div class="category"><h4>分类归档</h4><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Spring-Cloud-Gateway/">Spring-Cloud-Gateway</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/微服务/">微服务</a><span class="category-list-count">7</span></li></ul></div></div><div class="widget"><div class="tagcloud"><h4>标签云</h4><a href="/tags/Eureka/" style="font-size: 15px;">Eureka</a> <a href="/tags/Hystrix/" style="font-size: 10px;">Hystrix</a> <a href="/tags/微服务/" style="font-size: 20px;">微服务</a> <a href="/tags/网关/" style="font-size: 15px;">网关</a></div></div><div class="widget"><div class="recent"><h4>最近文章</h4><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/09/11/Hystrix之信号量隔离熔断/">Hystrix之信号量隔离熔断</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/04/Spring-Cloud-Gateway之配置路由过滤器/">Spring-Cloud-Gateway之配置路由过滤器</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/04/Spring-Cloud-Gateway之RoutePredicate/">Spring-Cloud-Gateway之RoutePredicate</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/04/Spring-Cloud-Gateway初始化/">Spring-Cloud-Gateway初始化</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/04/Eureka-Server之注册服务实例租约信息管理LeaseManager/">Eureka Server之注册服务实例租约信息管理LeaseManager</a></li></ul></div></div><div class="widget"><div id="arAnchorBar"></div></div></div></section></div><div class="right-menu"></div><div class="modal search-modal"><div class="input-field"><input type="text" id="search_input"><label for="search-input">搜索</label></div><div id="search_result" class="search-result"></div></div><div class="blog-overlay"></div><footer class="row"><div class="footer-con"><div class="paginator"><a href="/2018/09/04/Spring-Cloud-Gateway之RoutePredicate/" class="prev">上一篇</a><a href="/2018/09/04/Eureka-Server之注册服务实例租约信息管理LeaseManager/" class="next">下一篇</a></div><div class="copyright"><p>© 2017 - 2018 <a href="#" target="_blank">Mr.G</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> <br> and <a href="https://github.com/Bulandent/hexo-theme-bubuzou" target="_blank">hexo-theme-bubuzou</a></p><p>陕ICP备16007301</p></div><div class="totop"><i></i></div></div></footer><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script src="http://apps.bdimg.com/libs/jquery/1.8.2/jquery.min.js"></script><script src="https://cdn1.lncld.net/static/js/av-mini-0.6.10.js"></script><script src="/scripts/hit-kounter-lc-0.2.0.js"></script><script src="/scripts/arAnchor.js"></script><script src="/scripts/main.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>